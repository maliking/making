{"filter":false,"title":"blah.php","tooltip":"/labs/lab6/blah.php","undoManager":{"mark":17,"position":17,"stack":[[{"start":{"row":0,"column":0},"end":{"row":170,"column":7},"action":"insert","lines":["<?php","","   include '../../dbConnection.php';","   $conn = getDatabaseConnection();","   ","   function displayCountryOptions() {","       global $conn;","       $sql = \"SELECT DISTINCT(country) ","                FROM `q_author` ","                ORDER by country\";","        $stmt = $conn->prepare($sql);","        $stmt->execute();","        $records = $stmt->fetchAll(PDO::FETCH_ASSOC);","        ","        //print_r($records);","        ","        foreach ($records as $record) {","            echo \"<option \" ;","            ","            if ($record['country'] == $_GET['country'] ) {","                echo \"selected\";","            }","            ","            echo \">\" . $record['country'] . \"</option>\";","        }","        ","   }","   ","   ","    function displayCategoryOptions() {","       global $conn;","       $sql = \"SELECT * ","                FROM `q_category` ","                ORDER BY category\";","        $stmt = $conn->prepare($sql);","        $stmt->execute();","        $records = $stmt->fetchAll(PDO::FETCH_ASSOC);","        ","        //print_r($records);","        ","        foreach ($records as $record) {","            echo \"<option>\" . $record['category'] . \"</option>\";","        }","        ","   }","   ","   function displayQuotes(){","       global $conn;","       $sql = \"SELECT firstName, lastName, quote","                FROM q_author","                NATURAL JOIN q_quote","                WHERE 1\";","                ","        $namedParameters = array();","        ","        if (!empty($_GET['content'])) { //user typed something for quote content      ","           ","           //The following sql works BUT it allows SQL Injection!!","           //$sql = $sql . \" AND quote LIKE '%\".$_GET['content'].\"%'\";","           ","           //Preventing SQL injection","           $sql = $sql . \" AND quote LIKE :quoteContent\"; //using named parameters to avoid SQL injection","           $namedParameters[\":quoteContent\"] = \"%\" . $_GET['content'] . \"%\";","        }","        ","        ","        if (isset($_GET['gender'])) { //gender was checked by the user","            ","            $sql = $sql . \" AND gender = :gender \";","            $namedParameters[':gender'] = $_GET['gender'];","            ","            ","        }","        ","        ","        if (isset($_GET['orderBy'])) {","        ","            if ($_GET['orderBy'] == 'orderByAuthor') {","                ","               $sql = $sql . \" ORDER BY lastName\";","               ","            } else {","                ","                $sql = $sql . \" ORDER BY quote\";","            }","        ","        }","                ","        //echo $sql . \"<br><br>\";    ","        ","        ","                ","        $stmt = $conn->prepare($sql);","        $stmt->execute($namedParameters);","        $records = $stmt->fetchAll(PDO::FETCH_ASSOC);","        foreach ($records as $record) {","            echo \"<em>\" . $record['quote'] . \"</em> \" . $record['firstName'] . \" \" . $record['lastName'] . \"<br />\";","        }                ","                ","       ","       ","   }","     ","?>","","","<!DOCTYPE html>","<html>","    <head>","        <title>Lab 6: Quote Finder</title>","        <link rel=\"stylesheet\" type=\"text/css\" href=\"css/styles.css\" />","    </head>","    <body>","        <h1>Quote Finder</h1>","        <form method=\"get\">","                <strong>Quote Content:</strong>","                <input type=\"text\" name=\"content\" value=\"<?=$_GET['content']?>\">","                <strong>Author's Gender:</strong>","                <input type=\"radio\" name=\"gender\" id=\"female\" value=\"F\"","                ","                <?php ","                ","                 if ($_GET['gender'] == 'F') {","                     echo \" checked\";","                 }","                 ","                 ?>","                ","                >","                <label for=\"female\">Female</label>","                <input type=\"radio\" name=\"gender\" id=\"male\" value=\"M\"","                ","                <?php ","                ","                 if ($_GET['gender'] == 'M') {","                     echo \" checked\";","                 }","                 ","                 ?>","                ","                >","                <label for=\"male\">Male</label>","                <strong>Author's Birthplace:</strong>","                <select name=\"country\">","                    <option value=\"\">Select a Country</option>","                    <?=displayCountryOptions()?>","                </select>","                <strong>Category:</strong>  ","                <select name=\"category\">","                    <option value=\"\">Select a Category</option>","                    <?=displayCategoryOptions()?>","                </select>","                ","                Order by: ","                 <input type=\"radio\" name=\"orderBy\" id=\"orderByAuthor\" value=\"orderByAuthor\">","                <label for=\"orderByAuthor\">Author</label>","                 <input type=\"radio\" name=\"orderBy\" id=\"orderByQuote\" value=\"orderByQuote\">","                <label for=\"orderByQuote\">Quote</label>                ","                <input type=\"submit\" value=\"Filter\" name=\"submit\">","        </form>","","        <hr />","","        <div class=\"quotes\">","            ","            <?=displayQuotes()?>","            ","        </div>","        ","    </body>","</html>"],"id":1}],[{"start":{"row":4,"column":0},"end":{"row":4,"column":3},"action":"remove","lines":["   "],"id":2},{"start":{"row":7,"column":39},"end":{"row":7,"column":40},"action":"remove","lines":[" "]},{"start":{"row":8,"column":31},"end":{"row":8,"column":32},"action":"remove","lines":[" "]},{"start":{"row":13,"column":0},"end":{"row":13,"column":8},"action":"remove","lines":["        "]},{"start":{"row":15,"column":0},"end":{"row":15,"column":8},"action":"remove","lines":["        "]},{"start":{"row":18,"column":0},"end":{"row":18,"column":12},"action":"remove","lines":["            "]},{"start":{"row":22,"column":0},"end":{"row":22,"column":12},"action":"remove","lines":["            "]},{"start":{"row":25,"column":0},"end":{"row":25,"column":8},"action":"remove","lines":["        "]},{"start":{"row":27,"column":0},"end":{"row":27,"column":3},"action":"remove","lines":["   "]},{"start":{"row":28,"column":0},"end":{"row":28,"column":3},"action":"remove","lines":["   "]},{"start":{"row":31,"column":23},"end":{"row":31,"column":24},"action":"remove","lines":[" "]},{"start":{"row":32,"column":33},"end":{"row":32,"column":34},"action":"remove","lines":[" "]},{"start":{"row":37,"column":0},"end":{"row":37,"column":8},"action":"remove","lines":["        "]},{"start":{"row":39,"column":0},"end":{"row":39,"column":8},"action":"remove","lines":["        "]},{"start":{"row":43,"column":0},"end":{"row":43,"column":8},"action":"remove","lines":["        "]},{"start":{"row":45,"column":0},"end":{"row":45,"column":3},"action":"remove","lines":["   "]},{"start":{"row":52,"column":0},"end":{"row":52,"column":16},"action":"remove","lines":["                "]},{"start":{"row":54,"column":0},"end":{"row":54,"column":8},"action":"remove","lines":["        "]},{"start":{"row":55,"column":80},"end":{"row":55,"column":86},"action":"remove","lines":["      "]},{"start":{"row":56,"column":0},"end":{"row":56,"column":11},"action":"remove","lines":["           "]},{"start":{"row":59,"column":0},"end":{"row":59,"column":11},"action":"remove","lines":["           "]},{"start":{"row":64,"column":0},"end":{"row":64,"column":8},"action":"remove","lines":["        "]},{"start":{"row":65,"column":0},"end":{"row":65,"column":8},"action":"remove","lines":["        "]},{"start":{"row":67,"column":0},"end":{"row":67,"column":12},"action":"remove","lines":["            "]},{"start":{"row":70,"column":0},"end":{"row":70,"column":12},"action":"remove","lines":["            "]},{"start":{"row":71,"column":0},"end":{"row":71,"column":12},"action":"remove","lines":["            "]},{"start":{"row":73,"column":0},"end":{"row":73,"column":8},"action":"remove","lines":["        "]},{"start":{"row":74,"column":0},"end":{"row":74,"column":8},"action":"remove","lines":["        "]},{"start":{"row":76,"column":0},"end":{"row":76,"column":8},"action":"remove","lines":["        "]},{"start":{"row":78,"column":0},"end":{"row":78,"column":16},"action":"remove","lines":["                "]},{"start":{"row":80,"column":0},"end":{"row":80,"column":15},"action":"remove","lines":["               "]},{"start":{"row":82,"column":0},"end":{"row":82,"column":16},"action":"remove","lines":["                "]},{"start":{"row":85,"column":0},"end":{"row":85,"column":8},"action":"remove","lines":["        "]},{"start":{"row":87,"column":0},"end":{"row":87,"column":16},"action":"remove","lines":["                "]},{"start":{"row":88,"column":33},"end":{"row":88,"column":37},"action":"remove","lines":["    "]},{"start":{"row":89,"column":0},"end":{"row":89,"column":8},"action":"remove","lines":["        "]},{"start":{"row":90,"column":0},"end":{"row":90,"column":8},"action":"remove","lines":["        "]},{"start":{"row":91,"column":0},"end":{"row":91,"column":16},"action":"remove","lines":["                "]},{"start":{"row":97,"column":9},"end":{"row":97,"column":25},"action":"remove","lines":["                "]},{"start":{"row":98,"column":0},"end":{"row":98,"column":16},"action":"remove","lines":["                "]},{"start":{"row":99,"column":0},"end":{"row":99,"column":7},"action":"remove","lines":["       "]},{"start":{"row":100,"column":0},"end":{"row":100,"column":7},"action":"remove","lines":["       "]},{"start":{"row":102,"column":0},"end":{"row":102,"column":5},"action":"remove","lines":["     "]},{"start":{"row":119,"column":0},"end":{"row":119,"column":16},"action":"remove","lines":["                "]},{"start":{"row":120,"column":21},"end":{"row":120,"column":22},"action":"remove","lines":[" "]},{"start":{"row":121,"column":0},"end":{"row":121,"column":16},"action":"remove","lines":["                "]},{"start":{"row":125,"column":0},"end":{"row":125,"column":17},"action":"remove","lines":["                 "]},{"start":{"row":127,"column":0},"end":{"row":127,"column":16},"action":"remove","lines":["                "]},{"start":{"row":131,"column":0},"end":{"row":131,"column":16},"action":"remove","lines":["                "]},{"start":{"row":132,"column":21},"end":{"row":132,"column":22},"action":"remove","lines":[" "]},{"start":{"row":133,"column":0},"end":{"row":133,"column":16},"action":"remove","lines":["                "]},{"start":{"row":137,"column":0},"end":{"row":137,"column":17},"action":"remove","lines":["                 "]},{"start":{"row":139,"column":0},"end":{"row":139,"column":16},"action":"remove","lines":["                "]},{"start":{"row":147,"column":42},"end":{"row":147,"column":44},"action":"remove","lines":["  "]},{"start":{"row":152,"column":0},"end":{"row":152,"column":16},"action":"remove","lines":["                "]},{"start":{"row":153,"column":25},"end":{"row":153,"column":26},"action":"remove","lines":[" "]},{"start":{"row":157,"column":55},"end":{"row":157,"column":71},"action":"remove","lines":["                "]},{"start":{"row":164,"column":0},"end":{"row":164,"column":12},"action":"remove","lines":["            "]},{"start":{"row":166,"column":0},"end":{"row":166,"column":12},"action":"remove","lines":["            "]},{"start":{"row":168,"column":0},"end":{"row":168,"column":8},"action":"remove","lines":["        "]}],[{"start":{"row":14,"column":0},"end":{"row":15,"column":0},"action":"remove","lines":["        //print_r($records);",""],"id":3}],[{"start":{"row":13,"column":0},"end":{"row":14,"column":0},"action":"remove","lines":["",""],"id":4}],[{"start":{"row":36,"column":0},"end":{"row":37,"column":0},"action":"remove","lines":["        //print_r($records);",""],"id":5}],[{"start":{"row":35,"column":0},"end":{"row":36,"column":0},"action":"remove","lines":["",""],"id":6}],[{"start":{"row":52,"column":0},"end":{"row":54,"column":70},"action":"remove","lines":["","           //The following sql works BUT it allows SQL Injection!!","           //$sql = $sql . \" AND quote LIKE '%\".$_GET['content'].\"%'\";"],"id":7}],[{"start":{"row":51,"column":80},"end":{"row":52,"column":0},"action":"remove","lines":["",""],"id":8}],[{"start":{"row":53,"column":0},"end":{"row":54,"column":0},"action":"remove","lines":["           //Preventing SQL injection",""],"id":9}],[{"start":{"row":53,"column":57},"end":{"row":53,"column":71},"action":"remove","lines":[" //using named"],"id":10}],[{"start":{"row":53,"column":58},"end":{"row":53,"column":91},"action":"remove","lines":["parameters to avoid SQL injection"],"id":11}],[{"start":{"row":53,"column":57},"end":{"row":53,"column":58},"action":"remove","lines":[" "],"id":12}],[{"start":{"row":58,"column":37},"end":{"row":58,"column":70},"action":"remove","lines":[" //gender was checked by the user"],"id":13}],[{"start":{"row":51,"column":41},"end":{"row":51,"column":80},"action":"remove","lines":["/user typed something for quote content"],"id":14}],[{"start":{"row":51,"column":40},"end":{"row":51,"column":41},"action":"remove","lines":["/"],"id":15}],[{"start":{"row":79,"column":0},"end":{"row":82,"column":0},"action":"remove","lines":["","        //echo $sql . \"<br><br>\";","",""],"id":16}],[{"start":{"row":78,"column":9},"end":{"row":79,"column":0},"action":"remove","lines":["",""],"id":17}],[{"start":{"row":51,"column":39},"end":{"row":51,"column":40},"action":"remove","lines":[" "],"id":18}]]},"ace":{"folds":[],"scrolltop":1875,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":158,"column":7},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":true,"wrapToView":true},"firstLineState":{"row":115,"state":"tag_stuff","mode":"ace/mode/php"}},"timestamp":1509475195349,"hash":"15385acc0d3266253a50fe73bb2be3d68ffbfc37"}